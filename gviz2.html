
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
 
<html> 
  <head> 
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" /> 
    <title>Pivot Table &#187; </title> 
    <script type="text/javascript" src="http://www.google.com/jsapi"></script> 
    <script type="text/javascript"> 
      // Load the Visualization API and the table package.
      google.load('visualization', '1', {'packages':['table']});
    </script>  
        <script type="text/javascript" src="pivot2.js"></script>   
 
<script> 
google.setOnLoadCallback(drawChart);
 
 
function drawChart() {
  var gviz_table = new google.visualization.DataTable();
  gviz_table.addColumn('date', 'Date', 'date');
  gviz_table.addColumn('string', 'Department', 'dept');
  gviz_table.addColumn('string', 'Person', 'person');
  gviz_table.addColumn('number', 'Income', 'income');
  gviz_table.addColumn('number', 'Expense', 'expense');
  gviz_table.addRows(13);
  gviz_table.setCell(0, 0, new Date(2010,9,17));
  gviz_table.setCell(0, 1, 'Accounts');
  gviz_table.setCell(0, 2, 'Kate');
  gviz_table.setCell(0, 3, 0);
  gviz_table.setCell(0, 4, 10);
  gviz_table.setCell(1, 0, new Date(2010,9,17));
  gviz_table.setCell(1, 1, 'Marketing');
  gviz_table.setCell(1, 2, 'John');
  gviz_table.setCell(1, 3, 0);
  gviz_table.setCell(1, 4, 20);
  gviz_table.setCell(2, 0, new Date(2010,9,17));
  gviz_table.setCell(2, 1, 'Marketing');
  gviz_table.setCell(2, 2, 'Paul');
  gviz_table.setCell(2, 3, 6);
  gviz_table.setCell(2, 4, 15);
  gviz_table.setCell(3, 0, new Date(2010,9,17));
  gviz_table.setCell(3, 1, 'Accounts');
  gviz_table.setCell(3, 2, 'Mary');
  gviz_table.setCell(3, 3, 17);
  gviz_table.setCell(3, 4, 19);
  gviz_table.setCell(4, 0, new Date(2010,9,18));
  gviz_table.setCell(4, 1, 'Accounts');
  gviz_table.setCell(4, 2, 'Peter');
  gviz_table.setCell(4, 3, 0);
  gviz_table.setCell(4, 4, 3);
  gviz_table.setCell(5, 0, new Date(2010,9,18));
  gviz_table.setCell(5, 1, 'Marketing');
  gviz_table.setCell(5, 2, 'Vince');
  gviz_table.setCell(5, 3, 0);
  gviz_table.setCell(5, 4, 3);
  gviz_table.setCell(6, 0, new Date(2010,9,18));
  gviz_table.setCell(6, 1, 'Accounts');
  gviz_table.setCell(6, 2, 'Kate');
  gviz_table.setCell(6, 3, 0);
  gviz_table.setCell(6, 4, 3);
  gviz_table.setCell(7, 0, new Date(2010,9,18));
  gviz_table.setCell(7, 1, 'HR');
  gviz_table.setCell(7, 2, 'Laura');
  gviz_table.setCell(7, 3, 0);
  gviz_table.setCell(7, 4, 2);
  gviz_table.setCell(8, 0, new Date(2010,9,18));
  gviz_table.setCell(8, 1, 'Marketing');
  gviz_table.setCell(8, 2, 'John');
  gviz_table.setCell(8, 3, 1);
  gviz_table.setCell(8, 4, 13);
  gviz_table.setCell(9, 0, new Date(2010,9,18));
  gviz_table.setCell(9, 1, 'Marketing');
  gviz_table.setCell(9, 2, 'Paul');
  gviz_table.setCell(9, 3, 20);
  gviz_table.setCell(9, 4, 11);
  gviz_table.setCell(10, 0, new Date(2010,9,18));
  gviz_table.setCell(10, 1, 'Marketing');
  gviz_table.setCell(10, 2, 'Sarah');
  gviz_table.setCell(10, 3, 4);
  gviz_table.setCell(10, 4, 9);
  gviz_table.setCell(11, 0, new Date(2010,9,17));
  gviz_table.setCell(11, 1, 'Marketing');
  gviz_table.setCell(11, 2, 'Sarah');
  gviz_table.setCell(11, 3, 2);
  gviz_table.setCell(11, 4, 1);
  gviz_table.setCell(12, 0, new Date(2010,9,17));
  gviz_table.setCell(12, 1, 'Marketing');
  gviz_table.setCell(12, 2, 'Sarah');
  gviz_table.setCell(12, 3, 30);
  gviz_table.setCell(12, 4, 11);
 
 var formatter = new google.visualization.BarFormat({width: 120});
   var pivot = new gvizpivot.PivotAgg(
     gviz_table,
     {pivotKeyIndexes: [{column: 2}], // can be multiple
      pivotColumnIndex: {column: 0, sortDesc: true, aggregator: google.visualization.data.sum, columnTitleModifier: null},
      pivotValueIndex: {column:3}, // only one
      summaryColumns: [{label: 'Total', aggregator: google.visualization.data.sum, formatters:[formatter]}], // can be multiple
      usePercentTotalValues: false});
  var tbl = pivot.getDataTable();
  //tbl.sort({column:tbl.getNumberOfColumns()-2, desc:true})
  
 
  tablechart = new google.visualization.ChartWrapper({
    'chartType': 'Table',
    'containerId': 'base_gviztable',
    'dataTable': gviz_table,
  });
  
  tablechart2 = new google.visualization.ChartWrapper({
    'chartType': 'Table',
    'containerId': 'user_pivot_gviztable',
    'dataTable': tbl,
    'options': {
      allowHtml: true
    }
  });
  
  tablechart.draw();
  tablechart2.draw();
  
}
 
</script> 
 
 
  </head> 
  <body> 
 <p>Start table</p> 
<div id="base_gviztable"> 
</div> 
 
<br><br> 
<p>Pivoted by user (key), on date (column) using income (value)</p> 
<div id="user_pivot_gviztable"> 
</div> 
</body> 
</html>
